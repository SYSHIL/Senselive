<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>My App</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  </head>
  <body>
    <div class="container">
      <div id="rake" class="card">
        <div class="card-header">
          <h3 class="card-title">Rake</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col date">
              <h5>Date:</h5>
              <p>March 5, 2023</p>
            </div>
            <div class="col time">
              <h5>Time:</h5>
              <p>10:30 AM</p>
            </div>
            <div class="col temp">
              <h5>Temperature:</h5>
              <p id="Temperature"></p>
            </div>
          </div>
        </div>
      </div>
      <button id="getData" data-key="RAKE 1" class="btn btn-primary">Get Data</button>
    </div>
    <!-- The core Firebase JS SDK is always required and must be listed first -->

    <script src="./js/script.js"></script>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
      import { getDatabase,ref,get,set,child} from "https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js";

      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCNzRdlcfQeoN8a7L0jA04zhDamdpwyyJI",
        authDomain: "learnfirebase-f2755.firebaseapp.com",
        databaseURL: "https://learnfirebase-f2755-default-rtdb.asia-southeast1.firebasedatabase.app/",
        projectId: "learnfirebase-f2755",
        storageBucket: "learnfirebase-f2755.appspot.com",
        messagingSenderId: "994018527725",
        appId: "1:994018527725:web:d6978ce0e350bd778effe4",
        measurementId: "G-WBPJCQ3BK5"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      console.log(db);
      const dbRef = ref(getDatabase());
      // get data function
async function getData(rakeId) {
  try {
    const snapshot = await get(child(dbRef, `rakes/${rakeId}`));
    if (snapshot.exists()) {
      const temp = snapshot.val().rakeTemperature;
      return temp;
    } else {
      throw new Error("No data available");
    }
  } catch (error) {
    throw error;
  }
}

// Get the button element by ID
const getDataButton = document.getElementById("getData");

// Add an event listener to the button
getDataButton.addEventListener("click", async function (event) {
  try {
    // Get the data-key attribute from the button
    const key = event.target.getAttribute("data-key");
    // Call the getData function with the key argument
    const temperatureElement = document.getElementById("Temperature");
    const temperature = await getData(key);
    temperatureElement.innerHTML = temperature;
  } catch (error) {
    console.error(error);
    // Handle the error here by displaying a message to the user
    temperatureElement.innerHTML = "Error fetching temperature data";
  }
});

      
    </script>
  </body>
</html>